(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/vip/vip"],{"6f77":function(e,n,t){"use strict";(function(e,n){var i=t("47a9");t("e58b");i(t("3240"));var r=i(t("e3d0"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(r.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},"70cd":function(e,n,t){},"8c22":function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return i}));var i={uNavbar:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-navbar/u-navbar")]).then(t.bind(null,"d30e"))},uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"f11d"))},uGrid:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid/u-grid")]).then(t.bind(null,"12c0"))},uGridItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid-item/u-grid-item")]).then(t.bind(null,"5507"))}},r=function(){var e=this.$createElement;this._self._c},a=[]},a859:function(e,n,t){"use strict";var i=t("70cd"),r=t.n(i);r.a},d539:function(e,n,t){"use strict";t.r(n);var i=t("e8be"),r=t.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return i[e]}))}(a);n["default"]=r.a},e3d0:function(e,n,t){"use strict";t.r(n);var i=t("8c22"),r=t("d539");for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t("a859");var o=t("828b"),u=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);n["default"]=u.exports},e8be:function(e,n,t){"use strict";(function(e){var i=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=i(t("7eb4")),a=i(t("ee10")),o=getApp(),u={data:function(){return{showLogin:!1,shareId:"",ifSingle:1154==o.globalData.scene,fromSingle:1155==o.globalData.scene,userInfo:{is_vip:!1},canPay:!0,imgUrl:o.globalData.baseImageUrl,marginTop:o.globalData.marginTop,tabMargin:o.globalData.tabMargin,menu:[{icon:o.globalData.baseImageUrl+"/worker/vip_ic_4_white.png",title:"预定工作",url:"/pages/mine/mine"},{icon:o.globalData.baseImageUrl+"/worker/vip_ic_3_white.png",title:"优先匹配",url:"/pages/mine/mine"},{icon:o.globalData.baseImageUrl+"/worker/vip_ic_1_white.png",title:"工作分析",url:"/pages/mine/mine"},{icon:o.globalData.baseImageUrl+"/worker/vip_ic_2_white.png",title:"行业分析",url:"/pages/mine/mine"}]}},components:{login:function(){t.e("components/login").then(function(){return resolve(t("b921"))}.bind(null,t)).catch(t.oe)}},onLoad:function(n){var t=this;if(e.setNavigationBarColor({frontColor:"#000000",backgroundColor:"transparent"}),this.shareId=n.share_id?n.share_id:"",!this.ifSingle){var i=e.getSystemInfoSync();if("ios"==i.osName?this.$request("/ios/status").then((function(e){0==e.code&&e.data?t.canPay=!0:t.canPay=!1})):this.canPay=!0,this.fromSingle)return o.globalData.scene=0,void e.redirectTo({url:"/pages/index/index?share_id="+this.shareId});this.isLogin()&&this.getInfo()}},methods:{buyVip:function(){var n=this;return(0,a.default)(r.default.mark((function t(){var i,a,o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.isLogin()){t.next=3;break}return n.showLogin=!0,t.abrupt("return");case 3:if(n.canPay){t.next=6;break}return n.$refs.myModal.showModal({title:"由于相关规范，iOS成为会员功能暂不可用。",showCancel:!1}),t.abrupt("return");case 6:return i=n,t.next=9,n.getOrderId();case 9:return a=t.sent,t.next=12,n.getOrderParams(a);case 12:o=t.sent,e.requestPayment({appId:o.appId,timeStamp:o.timeStamp,nonceStr:o.nonceStr,package:o.package,signType:o.signType,paySign:o.paySign,success:function(){this.$refs.myModal.showModal({title:"支付成功",showCancel:!1,success:function(e){"confirm"==e&&i.getInfo()}})},fail:function(n){console.log(n,"err"),e.showToast({title:"支付已取消",icon:"error",duration:2e3})}});case 14:case"end":return t.stop()}}),t)})))()},closeLogin:function(){this.showLogin=!1},getOrderId:function(){var e=this;return new Promise((function(n){e.$request("/worker/vip-order",{},"POST").then((function(e){0==e.code&&n(e.data.order_id)}))}))},getOrderParams:function(e){var n=this;return new Promise((function(t){var i="/worker/order/"+e+"/pay";n.$request(i,{},"POST").then((function(e){0==e.code&&t(e.data.wechat_mini_program)}))}))},getInfo:function(){var n=this;this.$request("/worker/profile").then((function(t){0==t.code&&(e.setStorageSync("userInfo",JSON.stringify(t.data)),n.userInfo=t.data)}))}}};n.default=u}).call(this,t("df3c")["default"])}},[["6f77","common/runtime","common/vendor"]]]);