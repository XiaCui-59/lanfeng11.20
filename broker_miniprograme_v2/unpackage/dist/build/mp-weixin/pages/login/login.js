(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"08ed":function(t,e,n){"use strict";(function(t,e){var o=n("47a9");n("226a");o(n("3240"));var a=o(n("2f75"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},2059:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var o=function(){var t=this.$createElement;this._self._c},a=[]},"2f75":function(t,e,n){"use strict";n.r(e);var o=n("2059"),a=n("7715");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("a749");var s=n("828b"),r=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,"132930de",null,!1,o["a"],void 0);e["default"]=r.exports},3127:function(t,e,n){"use strict";(function(t){var o=n("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("7eb4")),i=o(n("ee10")),s=getApp(),r={data:function(){return{imgUrl:s.globalData.baseImageUrl,policyStatus:!1,showOtherLogin:!1,mobile:"",veri_code:"",password:"",currentTab:0,getPhoneData:{},canSend:!0,tipsText:"发送验证码",headHeight:s.globalData.loginHeadHeight,marginTop:s.globalData.marginTop,titleHeight:0,headTop:0,boxHeight:0,loginAreaTop:s.globalData.loginAreaTop,btnBottom:s.globalData.btnBottom}},onLoad:function(e){var n=t.getMenuButtonBoundingClientRect();this.titleHeight=n.height,this.headTop=n.top,this.boxHeight=s.globalData.systemHeight-this.loginAreaTop-this.btnBottom},methods:{changeTab:function(t){this.currentTab=t},checkPolicy:function(){this.policyStatus=!this.policyStatus},chooseLoginMethod:function(){this.showOtherLogin=!this.showOtherLogin},checkTab:function(t){this.currentTab=t},handlePolicy:function(){return!!this.policyStatus||(t.showToast({title:"请先勾选隐私协议",icon:"none",duration:2e3}),!1)},getOpenId:function(){var e=this;return new Promise((function(n){t.login({provider:"weixin",success:function(t){"login:ok"==t.errMsg&&e.$request("/auth/broker/wechat/mini/openid",{code:t.code},"POST").then((function(t){0==t.code&&n(t.data.open_id)}))},fail:function(){t.showModal({title:"登录失败",content:"授权登录失败，将无法使用部分功能",showCancel:!1})}})}))},getPhoneNumber:function(e){var n=this;return(0,i.default)(a.default.mark((function o(){var i;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i=n,o.next=3,n.getOpenId();case 3:n.getPhoneData.open_id=o.sent,t.setStorage({key:"openid",data:n.getPhoneData.open_id}),console.log(n.getPhoneData),console.log(e),"getPhoneNumber:ok"==e.detail.errMsg&&(n.getPhoneData.code=e.detail.code,i.$request("/auth/broker/wechat/mini/login",n.getPhoneData,"POST").then((function(e){0==e.code&&(t.showToast({title:"授权成功"}),t.setStorageSync("token",e.data),t.navigateBack())})));case 8:case"end":return o.stop()}}),o)})))()},getMessageCode:function(){var e=this,n=this;if(this.canSend){var o={mobile:this.mobile};this.$request("/auth/send-sms-verify-code",o,"POST").then((function(t){if(0==t.code){e.canSend=!1;var o=60;e.tipsText=o+"s";var a=setInterval((function(){o>0?(o--,n.tipsText=o+"s"):(n.canSend=!0,n.tipsText="重新获取",clearInterval(a))}),1e3)}}))}else t.showModal({title:"验证码已发送，请稍后重试",showCancel:!1})},codeLogin:function(){if(this.handlePolicy()){var e={mobile:this.mobile,sms_verify_code:this.veri_code};this.$request("/auth/broker/login/sms",e,"POST").then((function(e){0==e.code&&(t.showToast({title:"登录成功",duration:2e3}),t.setStorageSync("token",e.data.token),t.navigateBack())}))}},passwordLogin:function(){if(this.handlePolicy()){var e={mobile:this.mobile,password:this.password};this.$request("/auth/broker/login/password",e,"POST").then((function(e){0==e.code&&(t.showToast({title:"登录成功",duration:2e3}),t.setStorageSync("token",e.data.token),t.navigateBack())}))}},back:function(){t.switchTab({url:"/pages/index/index"})}}};e.default=r}).call(this,n("df3c")["default"])},7715:function(t,e,n){"use strict";n.r(e);var o=n("3127"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},a749:function(t,e,n){"use strict";var o=n("ba0b"),a=n.n(o);a.a},ba0b:function(t,e,n){}},[["08ed","common/runtime","common/vendor"]]]);