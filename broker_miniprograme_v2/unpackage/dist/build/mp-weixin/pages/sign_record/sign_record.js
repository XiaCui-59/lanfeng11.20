(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sign_record/sign_record"],{"0ebd":function(t,e,o){"use strict";var n=o("5cc8"),i=o.n(n);i.a},"3db1":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return n}));var n={uSearch:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-search/u-search")]).then(o.bind(null,"6350"))},uniDataSelect:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uni-data-select/components/uni-data-select/uni-data-select")]).then(o.bind(null,"de3e"))},uIcon:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(o.bind(null,"7fbf"))},uPopup:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(o.bind(null,"2dd4"))},uTag:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-tag/u-tag")]).then(o.bind(null,"6b8f"))},"u-Input":function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u--input/u--input")]).then(o.bind(null,"cf09"))},uButton:function(){return Promise.all([o.e("common/vendor"),o.e("uni_modules/uview-ui/components/u-button/u-button")]).then(o.bind(null,"0a65"))}},i=function(){var t=this,e=t.$createElement,o=(t._self._c,t.status.slice(0,5)),n=t.list.length,i=t.list.length,r=t.__map(t.list,(function(e,o){var n=t.__get_orig(e),r=i>0?t.status.filter((function(t){return t.value==e.status})):null;return{$orig:n,g3:r}})),a=t.list.length,s={bottom:t.pickerBottom+"px"},u=t.projectList.length,c=t.projectList.length,l=t.__map(t.followStatus,(function(e,o){var n=t.__get_orig(e),i=t.status.filter((function(t){return t.value==e.status}));return{$orig:n,g7:i}})),h=t.__map(t.followList,(function(e,o){var n=t.__get_orig(e),i=t.status.filter((function(t){return t.value==e.status}));return{$orig:n,g8:i}})),d=t.followList.length;t.$mp.data=Object.assign({},{$root:{g0:o,g1:n,g2:i,l0:r,g4:a,a0:s,g5:u,g6:c,l1:l,l2:h,g9:d}})},r=[]},"5cc8":function(t,e,o){},"6a7e":function(t,e,o){"use strict";(function(t,e){var n=o("47a9");o("226a");n(o("3240"));var i=n(o("a8e0"));t.__webpack_require_UNI_MP_PLUGIN__=o,e(i.default)}).call(this,o("3223")["default"],o("df3c")["createPage"])},"8f78":function(t,e,o){"use strict";(function(t){var n=o("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(o("7eb4")),r=n(o("ee10")),a=n(o("b115")),s=getApp(),u={data:function(){return{currentWorker:{},followStatus:[],curFollowStatus:"",followList:[],followValue:"",showPop:!1,showPickerMask:!1,showAddInfo:!1,showNameInput:!0,showLogin:!1,imgUrl:s.globalData.baseImageUrl,pageName:"报名记录",showModal:!1,marginTop:s.globalData.marginTop,mainTabHeight:s.globalData.mainTabHeight,subTabHeight:s.globalData.subTabHeight,tabMargin:s.globalData.tabMargin,keyword:"",pickerKeyword:"",statusValue:"",status:a.default.workerStatus,reqStatus:[{value:"",text:"全部状态"},{value:"wait-check-in",text:"候选中"},{value:"check-in",text:"待面试"},{value:"wait-entry",text:"待入职"},{value:"entry",text:"已入职"}],list:[],scrollHeight:0,boxTop:0,headerHeight:s.globalData.highTopHeight,tabbarHeight:0,currentPage:1,pagination:{},loginStatus:!1,userInfo:{},projectList:[],propagination:{},currentProPage:1,recordScroll:0,pickerBottom:0}},components:{tabbar:function(){o.e("components/tabbar").then(function(){return resolve(o("14ab"))}.bind(null,o)).catch(o.oe)},customHeader:function(){o.e("components/custom_header").then(function(){return resolve(o("731d"))}.bind(null,o)).catch(o.oe)},infoFirst:function(){o.e("components/info_first").then(function(){return resolve(o("c320"))}.bind(null,o)).catch(o.oe)}},onLoad:function(){var e=this;this.boxTop=this.marginTop+2*this.tabMargin+this.subTabHeight,this.scrollHeight=s.globalData.systemHeight-this.marginTop-2*this.tabMargin-this.subTabHeight-this.tabbarHeight,t.onKeyboardHeightChange((function(t){console.log(t.height,"键盘高度变化"),e.pickerBottom=t.height})),this.isLogin()&&(this.loginStatus=!0)},watch:{},onShow:function(){var t=this;return(0,r.default)(i.default.mark((function e(){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isLogin()){e.next=11;break}return t.loginStatus=!0,t.currentPage=1,t.getList(),e.next=6,t.getInfo();case 6:t.userInfo=e.sent,"waiting_submit"!=t.userInfo.broker.review_status&&"rejected"!=t.userInfo.broker.review_status||(t.showAddInfo=!0),t.userInfo.broker.name&&(t.showNameInput=!1),e.next=14;break;case 11:t.showLogin=!0,t.loginStatus=!1,t.list=[];case 14:case"end":return e.stop()}}),e)})))()},methods:{toWorkerDetail:function(e){var o=encodeURIComponent(JSON.stringify(e));t.navigateTo({url:"/subpkg/worker_detail/worker_detail?worker_info="+o})},getElementInfo:function(e){return new Promise((function(o){var n=t.createSelectorQuery().select(e);n.boundingClientRect((function(t){o(t)})).exec()}))},editFollow:function(t){var e=this;this.currentWorker=t;var o="/broker/log/"+t.worker_id+"/"+t.project_id;this.$request(o).then((function(t){0==t.code&&(e.followStatus=t.data,e.curFollowStatus=t.data[t.data.length-1],e.openPop())}))},radioClick:function(t){console.log("item",t),this.curFollowStatus=t},openPop:function(){var t=this;return(0,r.default)(i.default.mark((function e(){var o;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showPop=!0,e.next=3,t.getElementInfo(".record_list");case 3:o=e.sent,o&&(t.recordScroll=s.globalData.systemHeight-o.top-15),t.getFollowList();case 6:case"end":return e.stop()}}),e)})))()},closePop:function(){this.showPop=!1},openPicker:function(){this.pickerKeyword="",this.currentProPage=1,this.getProject()},chooseProject:function(t){this.close(),this.keyword=t.name,this.getList()},showPicker:function(){console.log(123),this.showPickerMask=!0},close:function(){this.showPickerMask=!1,this.currentProPage=1},change:function(t){this.currentProPage=1,this.getProject()},changeItem:function(){},statusChange:function(){this.getList()},handleName:function(){this.showNameInput=!1},closeAddInfo:function(){this.showAddInfo=!1},handleInfo:function(t){t.company.name||(this.showAddInfo=!0),t.broker.name&&(this.showNameInput=!1)},closeLogin:function(){this.showLogin=!1},getTabbarHeight:function(t){this.tabbarHeight=t},handleCancel:function(){this.showModal=!1},getFollowList:function(){var t=this,e="/broker/remarks/"+this.currentWorker.worker_id+"/"+this.currentWorker.project_id;this.$request(e).then((function(e){0==e.code&&(t.followList=e.data)}))},getMore:function(){var t=this,e="/broker/project/signing-requests?page="+this.currentPage+"&page_size=15&project_search="+("全部职位"==this.keyword?"":this.keyword)+"&status="+this.statusValue;this.$request(e).then((function(e){0==e.code&&(t.list=t.list.concat(e.data.list),t.pagination=e.data.pagination)}))},gerMorePro:function(){this.projectList.length<this.propagination.totalCount?(this.currentProPage++,this.getMoreProjects()):this.projectList.length>=this.propagination.totalCount&&t.showToast({title:"已经到底啦~",icon:"none",duration:2e3})},getMoreProjects:function(){var t=this,e="/broker/projects?keyword="+this.pickerKeyword+"&page="+this.currentProPage;this.$request(e).then((function(e){0==e.code&&(t.projectList=t.projectList.concat(e.data.list),t.propagination=e.data.pagination)}))},getProject:function(){var t=this,e="/broker/projects?keyword="+this.pickerKeyword+"&page="+this.currentProPage;this.$request(e).then((function(e){0==e.code&&(t.projectList=e.data.list,t.propagination=e.data.pagination)}))},getList:function(){var t=this,e="/broker/project/signing-requests?page="+this.currentPage+"&page_size=15&project_search="+("全部职位"==this.keyword?"":this.keyword)+"&status="+this.statusValue;this.$request(e).then((function(e){0==e.code&&(t.list=e.data.list,t.pagination=e.data.pagination)}))},lower:function(){this.list.length<this.pagination.totalCount?(this.currentPage++,this.getMore()):this.list.length>=this.pagination.totalCount&&t.showToast({title:"已经到底啦~",icon:"none",duration:2e3})},confirmFollow:function(){var e=this,o={worker_id:this.currentWorker.worker_id,project_id:this.currentWorker.project_id,change_log_id:this.curFollowStatus.id,remark:this.followValue};this.$request("/broker/add/remarks",o,"POST").then((function(o){0==o.code&&(t.showToast({title:"添加成功",duration:1e3}),e.followValue="",e.closePop())}))},checkIn:function(e,o){var n=this,i=[];i[0]=e.id;var r={relation_id:i};this.$request("/broker/project/requests-cost",r,"POST").then((function(i){if(console.log(i),0==i.code)if(console.log(i.data),Number(i.data.cost)>Number(i.data.amount))t.showModal({title:"余额不足，请先充值",showCancel:!1,success:function(e){e.confirm&&t.navigateTo({url:"/subpkg/recharge/recharge"})}});else{var r=o?"接收":"拒绝";t.showModal({title:"提示",content:"当前操作"+r+"的工人："+e.worker_name,success:function(i){if(i.confirm){var r=o?"已接收":"已拒绝",a=[];a.push(e.id);var s={relation_id:a,project_id:e.project_id,confirm:o,remark:""};n.$request("/broker/mini/project/check-in",s,"POST").then((function(e){0==e.code&&(t.showModal({title:r,showCancel:!1}),n.list=[],n.getList())}))}}})}}))},toSign:function(e,o){var n=this,i=o?"面试通过":"不通过";t.showModal({title:"提示",content:"当前标记"+i+"的工人："+e.worker_name,success:function(i){if(i.confirm){var r=o?"已通过面试":"已标记不通过",a=[];a.push(e.id);var s={relation_id:a,project_id:e.project_id,confirm:o,remark:""};n.$request("/broker/mini/project/contract-confirm",s,"POST").then((function(e){0==e.code&&(t.showModal({title:r,showCancel:!1}),n.list=[],n.getList())}))}}})},toEntry:function(e,o){var n=this,i=o?"确认入职":"未入职";t.showModal({title:"提示",content:"当前标记"+i+"的工人："+e.worker_name,success:function(i){if(i.confirm){var r=o?"已确认入职":"已标记未入职",a=[];a.push(e.id);var s={relation_id:a,project_id:e.project_id,confirm:o,remark:""};n.$request("/broker/mini/project/entry-confirm",s,"POST").then((function(e){0==e.code&&(t.showModal({title:r,showCancel:!1}),n.list=[],n.getList())}))}}})},makePhoneCall:function(e){t.makePhoneCall({phoneNumber:e})},depart:function(e){var o=this,n=[];n.push(e.id);var i={relation_id:n,project_id:e.project_id,remark:""};t.showModal({title:"离职操作",content:"当前离职正在办理离职的员工为："+e.worker_name+"，是否确认离职？",success:function(e){e.confirm&&o.$request("/broker/mini/project/confirm-depart-user",i,"POST").then((function(e){0==e.code&&(t.showModal({title:"离职成功",showCancel:!1}),o.list=[],o.getList())}))}})}}};e.default=u}).call(this,o("df3c")["default"])},a8e0:function(t,e,o){"use strict";o.r(e);var n=o("3db1"),i=o("c5a2");for(var r in i)["default"].indexOf(r)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(r);o("0ebd");var a=o("828b"),s=Object(a["a"])(i["default"],n["b"],n["c"],!1,null,"92be0c06",null,!1,n["a"],void 0);e["default"]=s.exports},c5a2:function(t,e,o){"use strict";o.r(e);var n=o("8f78"),i=o.n(n);for(var r in n)["default"].indexOf(r)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a}},[["6a7e","common/runtime","common/vendor"]]]);