(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/addmore_project_info/addmore_project_info"],{3227:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={htzImageUpload:function(){return Promise.all([n.e("common/vendor"),n.e("components/htz-image-upload/htz-image-upload")]).then(n.bind(null,"5418"))}},o=function(){var e=this.$createElement;this._self._c},a=[]},"59db":function(e,t,n){"use strict";n.r(t);var i=n("3227"),o=n("6e5f");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("8e12");var r=n("828b"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=s.exports},"63cc":function(e,t,n){"use strict";(function(e,t){var i=n("47a9");n("226a");i(n("3240"));var o=i(n("59db"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},"6e5f":function(e,t,n){"use strict";n.r(t);var i=n("c4ef"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},"8e12":function(e,t,n){"use strict";var i=n("c269"),o=n.n(i);o.a},c269:function(e,t,n){},c4ef:function(e,t,n){"use strict";(function(e){var i=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n("7eb4")),a=i(n("ee10")),r=getApp(),s={data:function(){return{interviewerMobile:"",interviewer:"",showModal:!1,pageName:"完善职位信息",headerHeight:r.globalData.topHeight,subTabHeight:r.globalData.subTabHeight,tabMargin:r.globalData.tabMargin,marginTop:r.globalData.marginTop,btnBottom:r.globalData.btnBottom,welfareArr:[],welIds:[],welfare:"",workArr:[],workIds:[],work_info:"",currentBenefit:[],currentTagType:"",currentBenefitIds:[],currentSelectInfo:[],currentInfoIds:[],showTag:!1,tagsObj:{},scrollHeight:0,videoValue:[],imageValue:[],videoData:[],videoKeys:[{key:"",url:""}],imageKeys:[],imageData:[],id:""}},components:{tagSelect:function(){n.e("components/tag_select").then(function(){return resolve(n("0591"))}.bind(null,n)).catch(n.oe)},customHeader:function(){n.e("components/custom_header").then(function(){return resolve(n("731d"))}.bind(null,n)).catch(n.oe)},htzImageUpload:function(){Promise.all([n.e("common/vendor"),n.e("components/htz-image-upload/htz-image-upload")]).then(function(){return resolve(n("5418"))}.bind(null,n)).catch(n.oe)}},onLoad:function(e){var t=this;return(0,a.default)(o.default.mark((function n(){var i,a,s,c;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.id=e.id,t.scrollHeight=r.globalData.systemHeight-t.marginTop-t.tabMargin,n.next=4,t.loadInfo();case 4:for(i=n.sent,a=0;a<i.images.length;a++)s={type:0,url:i.images[a].url,index:a},t.imageData.push(s),t.imageKeys=i.images;for(c=0;c<i.videos.length;c++)t.videoData.push(i.videos[c].url),t.videoKeys[0].key=i.videos[0].key,t.videoKeys[0].url=i.videos[0].url;t.interviewer=i.interview_contact_name,t.interviewerMobile=i.interview_contact_mobile,console.log(t.currentInfoIds,t.currentBenefitIds);case 10:case"end":return n.stop()}}),n)})))()},methods:{handleCancel:function(){e.switchTab({url:"/pages/index/index"})},handleConfirm:function(){e.redirectTo({url:"/subpkg/set_fee/set_fee?id="+this.id})},uploadVideo:function(e){this.videoData=e,this.loadimg("project_video",e[0]),console.log(e)},uploadImage:function(e){console.log(e);for(var t=e.length,n=0;n<t;n++){var i={type:0,url:e[n],index:this.imageKeys.length};this.loadimg("project_image",e[n]),this.imageData.push(i)}},imgDelete:function(e){console.log(e.del.index),e.del.index<this.imageKeys.length?this.imageKeys.splice(e.del.index,1):e.del.index==this.imageKeys.length&&this.imageKeys.splice(e.del.index-1,1)},loadimg:function(t,n){var i=this;return(0,a.default)(o.default.mark((function a(){var s,c;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return s=i,c={Authorization:"bearer "+e.getStorageSync("token"),accept:"application/json"},o.abrupt("return",new Promise((function(i,o){e.uploadFile({url:r.globalData.baseUrl+"/broker/upload?type="+t,filePath:n,name:"file",header:c,success:function(n){var i=JSON.parse(n.data);0==i.code?("project_video"==t&&(s.$set(s.videoKeys[0],"key",i.data.key),s.$set(s.videoKeys[0],"url",i.data.url)),"project_image"==t&&s.imageKeys.push(i.data),console.log(s.videoKeys,s.imageKeys)):e.showModal({title:"上传失败",content:i.msg})},complete:function(){}})})));case 3:case"end":return o.stop()}}),a)})))()},loadInfo:function(){var e=this;return new Promise((function(t){var n="/broker/mini/project/"+e.id+"/info";e.$request(n).then((function(e){0==e.code&&t(e.data)}))}))},getInfo:function(){var t="/broker/mini/project/"+this.id+"/info";this.$request(t).then((function(t){0==t.code&&e.switchTab({url:"/pages/index/index"})}))},save:function(){var t=this;console.log(this.videoKeys,this.imageKeys,"savevie");var n={interview_contact_name:this.interviewer,interview_contact_mobile:this.interviewerMobile,videos:this.videoKeys,images:this.imageKeys},i="/broker/mini/project/"+this.id+"/option-fields";this.$request(i,n,"POST").then((function(n){0==n.code&&(e.showToast({title:"保存成功",duration:3e3}),t.getInfo())}))}}};t.default=s}).call(this,n("df3c")["default"])}},[["63cc","common/runtime","common/vendor"]]]);