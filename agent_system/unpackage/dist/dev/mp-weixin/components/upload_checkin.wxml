<view data-event-opts="{{[['tap',[['colsePro',['$event']]]]]}}" class="board" bindtap="__e"><view class="box"><view class="title">上传考勤</view><view class="down_area"><view data-event-opts="{{[['tap',[['downloadExcel',['$event']]]]]}}" class="down" style="width:150px;" bindtap="__e">点此下载考勤模板</view><view class="tips">(请先下载系统提供的考勤模板，然后按照系统提供的格式填写考勤数据后再上传到系统，请勿擅自修改文件格式。已经下载的无需重复下载。)</view></view><view class="line"><view class="tit">项目名称</view><view data-event-opts="{{[['tap',[['showPro',['$event']]]]]}}" class="input_wrap" catchtap="__e"><input type="text" placeholder="请选择项目" maxlength="32" data-event-opts="{{[['input',[['__set_model',['','projectName','$event',[]]],['filterProject',['$event']]]]]}}" value="{{projectName}}" bindinput="__e"/></view><block wx:if="{{showComMask}}"><view class="com_mask"><block wx:for="{{proList}}" wx:for-item="item" wx:for-index="index" wx:key="id"><view data-event-opts="{{[['tap',[['chooseProject',['$0'],[[['proList','id',item.id]]]]]]]}}" class="com_item" bindtap="__e">{{''+("("+item.code+")"+item.name)+''}}</view></block></view></block></view><view class="line"><view class="tit">附件上传</view><view class="input_wrap noborder"><block wx:if="{{fileName}}"><view class="file flex flex-start"><view class="name flex flex-start" style="color:#0092ff;"><image style="height:18px;width:18px;margin-right:5px;" src="/static/file_icon.png" mode="widthFix"></image><view>{{fileName}}</view></view><view data-event-opts="{{[['tap',[['deleFile',['$event']]]]]}}" class="btn dele" bindtap="__e">删除</view></view></block><block wx:if="{{!fileName}}"><view data-event-opts="{{[['tap',[['loadFile',['$event']]]]]}}" class="file_upload" bindtap="__e"><view class="file_btn"><image style="width:35px;height:35px;" src="/static/upload_icon.png" mode="widthFix"></image><view>点击上传</view></view></view></block></view></view><view class="line"><view class="tit">文件示例</view><view class="input_wrap noborder"><image style="width:100%;" src="/static/example.png" mode="widthFix" data-event-opts="{{[['tap',[['previewImage',['$event']]]]]}}" bindtap="__e"></image></view></view><view class="line"><view data-event-opts="{{[['tap',[['submit',['$event']]]]]}}" class="btn" bindtap="__e">开始解析</view></view></view><block wx:if="{{showMask}}"><view class="mask"><block wx:if="{{showAdd}}"><view class="inner"><view class="title" style="margin-bottom:30px;">新增考勤模板</view><view data-event-opts="{{[['tap',[['close',['$event']]]]]}}" class="close" bindtap="__e"><image src="/static/close_white.png" mode="widthFix"></image></view><view class="box"><view class="line flex flex-start"><view class="tit">模板名称：</view><view class="input_wrap"><input type="text" placeholder="请输入模板名称" data-event-opts="{{[['input',[['__set_model',['','tempName','$event',[]]]]]]}}" value="{{tempName}}" bindinput="__e"/></view></view><view class="line flex flex-start"><view class="tit">数据起始行</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','startRow','$event',[]]]]]]}}" value="{{startRow}}" bindinput="__e"/>行</view></view><view class="line flex flex-start"><view class="tit" style="width:130px;">考勤字段对应列：</view></view><view class="wrap flex flex-start"><view class="line flex flex-start" style="margin-right:50px;"><view class="tit">工人名称：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','nameC','$event',[]]]]]]}}" value="{{nameC}}" bindinput="__e"/>列</view></view><view class="line flex flex-start"><view class="tit">身份证号：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','idcardC','$event',[]]]]]]}}" value="{{idcardC}}" bindinput="__e"/>列</view></view></view><view class="wrap flex flex-start"><view class="line flex flex-start" style="margin-right:50px;"><view class="tit">起始时间：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','startTimeC','$event',[]]]]]]}}" value="{{startTimeC}}" bindinput="__e"/>列</view></view><view class="line flex flex-start"><view class="tit">结束时间：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','endTimeC','$event',[]]]]]]}}" value="{{endTimeC}}" bindinput="__e"/>列</view></view></view><view class="wrap flex flex-start"><view class="line flex flex-start" style="margin-right:50px;"><view class="tit">工作时长：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','timeC','$event',[]]]]]]}}" value="{{timeC}}" bindinput="__e"/>列</view></view><view class="line flex flex-start" style="margin-right:50px;"><view class="tit">计时类型：</view><view class="input_wrap noborder flex flex-start">第<input style="width:60px;background:#eee;text-align:center;padding-left:0;margin:0 10px;" type="text" data-event-opts="{{[['input',[['__set_model',['','typeC','$event',[]]]]]]}}" value="{{typeC}}" bindinput="__e"/>列</view></view></view><view data-event-opts="{{[['tap',[['sureAdd',['$event']]]]]}}" class="btn" style="margin:0 auto;" bindtap="__e">新增</view></view></view></block><block wx:if="{{showResult}}"><view class="inner"><view class="title">考勤记录数据校验</view><view data-event-opts="{{[['tap',[['close',['$event']]]]]}}" class="close" bindtap="__e"><image src="/static/close_white.png" mode="widthFix"></image></view><view class="box"><view class="subtit">正常<text class="active">{{resultData.success_count}}</text>条/异常<text class="disable">{{resultData.fail_count}}</text>条</view><view class="table_wrap"><uni-table style="height:500px;" vue-id="4e6f7bdc-1" border="{{true}}" stripe="{{true}}" emptyText="暂无更多数据" bind:__l="__l" vue-slots="{{['default']}}"><uni-tr style="background:#f6f6f6;" vue-id="{{('4e6f7bdc-2')+','+('4e6f7bdc-1')}}" bind:__l="__l" vue-slots="{{['default']}}"><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-3')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">工人名称</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-4')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">身份证号码</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-5')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">开始时间</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-6')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">结束时间</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-7')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">考勤方式</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-8')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">工作时长</uni-th><uni-th style="font-size:14px;font-weight:600;color:#333;" vue-id="{{('4e6f7bdc-9')+','+('4e6f7bdc-2')}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">备注</uni-th></uni-tr><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><uni-tr vue-id="{{('4e6f7bdc-10-'+index)+','+('4e6f7bdc-1')}}" bind:__l="__l" vue-slots="{{['default']}}"><uni-td style="{{'color:'+(item.g0?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-11-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.worker_name}}</uni-td><uni-td style="{{'color:'+(item.g1?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-12-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.id_card_number}}</uni-td><uni-td style="{{'color:'+(item.g2?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-13-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.start_time}}</uni-td><uni-td style="{{'color:'+(item.g3?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-14-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.end_time}}</uni-td><uni-td style="{{'color:'+(item.g4?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-15-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.working_type}}</uni-td><uni-td style="{{'color:'+(item.g5?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-16-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}">{{item.$orig.working_time}}</uni-td><uni-td style="{{'color:'+(item.g6?'#f00':'#333')+';'}}" vue-id="{{('4e6f7bdc-17-'+index)+','+('4e6f7bdc-10-'+index)}}" align="center" bind:__l="__l" vue-slots="{{['default']}}"><block wx:for="{{item.$orig.errors}}" wx:for-item="item2" wx:for-index="index2"><view>{{item2}}</view></block></uni-td></uni-tr></block></uni-table></view><view class="btns flex flex_around" style="margin-top:20px;"><view data-event-opts="{{[['tap',[['close',['$event']]]]]}}" class="btn" style="height:40px;line-height:40px;background:transparent;border:1px solid #999;color:#333;" bindtap="__e">取消</view><view data-event-opts="{{[['tap',[['confirm',['$event']]]]]}}" class="btn" style="{{'height:40px;line-height:40px;'+('background:'+(resultData.fail_count>0?'#ccc':'#1E8EEE')+';')}}" bindtap="__e">确认上传</view></view></view></view></block></view></block></view>